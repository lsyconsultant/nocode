<mvc:View controllerName="sap.ui.eland.controller.campaign.campaignCreate"
          xmlns:mvc="sap.ui.core.mvc"
          xmlns="sap.m"
          xmlns:core="sap.ui.core"
          xmlns:form="sap.ui.layout.form"
          xmlns:u="sap.ui.unified"
          xmlns:tnt="sap.tnt"
          xmlns:t="sap.ui.table" height="100%" class="mainStyle">

    <Page id="campaign" showHeader="false" class="sapUiResponsivePadding--header">
        <subHeader>
            <OverflowToolbar>
                <content>
                    <Title text="캠페인 생성"/>
                    <ToolbarSpacer/>
                    <Button text="편집"/>
                </content>
            </OverflowToolbar>
        </subHeader>

        <content>
            <IconTabBar id="idIconTabBarInlineMode" selectedKey="{/selectedTab}" expandable="false"
                        class="tabStyle" select="onSelectTab">
                <items>
                    <IconTabFilter text="기본정보" key="segment">
                        <form:SimpleForm id="SimpleFormDisplay480_12120" editable="true"
                                         layout="ResponsiveGridLayout" labelSpanXL="4" labelSpanL="4"
                                         labelSpanM="12" labelSpanS="12" adjustLabelSpan="false"
                                         emptySpanXL="0" emptySpanL="0" emptySpanM="0" emptySpanS="0"
                                         columnsXL="2" columnsL="2" columnsM="1"
                                         singleContainerFullSize="false">
                            <form:content>
                                <core:Title text=""/>
                                <Label text="ID"/>
                                <Text text="2302-F-D001-00003WR"/>
                                <Label text="기간"/>
                                <DateRangeSelection width="300px" delimiter="~"
                                                    dateValue="{/campaign/basicInfo/startDate}"
                                                    secondDateValue="{/campaign/basicInfo/endDate}"
                                                    displayFormat="yyyy-MM-dd" valueFormat="yyyy-MM-dd"/>
                                <Label text="캠페인명"/>
                                <Input value="{/campaign/basicInfo/name}"/>
                                <Label text="설명"/>
                                <TextArea value="{/campaign/basicInfo/desc}"/>
                                <core:Title text=""/>
                                <Label text="생성자"/>
                                <Text text="{/campaign/basicInfo/createBy}"/>
                                <Label text="생성일"/>
                                <Text text="{/campaign/basicInfo/createDatetime}"/>
                                <Label text="수정자"/>
                                <Text text="{/campaign/basicInfo/modifyBy}"/>
                                <Label text="수정일"/>
                                <Text text="{/campaign/basicInfo/modifyDatetime}"/>
                            </form:content>
                        </form:SimpleForm>
                    </IconTabFilter>
                    <IconTabSeparator icon="sap-icon://arrow-right"/>
                    <IconTabFilter text="유형 설정" key="campaignType">
                        <Label labelFor="rbg1" text="캠페인 유형 설정"/>
                        <RadioButtonGroup id="campTypeRadio" select="onCampaignTypeClick" selectedIndex="-1"
                                          columns="4" width="100%" class="sapUiMediumMarginBottom">
                            <RadioButton id="schedule" text="스케쥴 캠페인"/>
                            <RadioButton id="userAction" text="유저 액션 캠페인"/>
                            <RadioButton id="apiCall" text="API 호출 기반 캠페인"/>
                            <RadioButton id="canvas" text="Canvas 시나리오 캠페인"/>
                        </RadioButtonGroup>

                        <VBox visible="{=${/selectCampType} === 'schedule'}">
                            <Title text="스케쥴 캠페인 설정"/>
                            <RadioButtonGroup id="scheduleType" select="onScheduelTypeClick"
                                              selectedIndex="-1" columns="4" width="100%"
                                              class="sapUiMediumMarginBottom">
                                <RadioButton id="once" text="한번만"/>
                                <RadioButton id="cycle" text="정기적으로"/>
                            </RadioButtonGroup>

                            <VBox visible="{=${/scheduleType} === 'once'}">
                                <form:SimpleForm editable="true" layout="ResponsiveGridLayout"
                                                 labelSpanXL="4" labelSpanL="4" labelSpanM="12"
                                                 labelSpanS="12" adjustLabelSpan="false" emptySpanXL="0"
                                                 emptySpanL="0" emptySpanM="0" emptySpanS="0" columnsXL="2"
                                                 columnsL="2" columnsM="1" singleContainerFullSize="false">
                                    <form:content>
                                        <core:Title text=" 발송 일정"/>
                                        <Label text="발송 시간"/>
                                        <DateTimePicker id="DTP1" width="200px" enabled="true"
                                                        class="sapUiSmallMarginBottom"
                                                        valueFormat="yyyy-MM-dd HH:mm"
                                                        displayFormat="yyyy-MM-dd HH:mm"
                                                        value="{/send_datetime}"/>
                                    </form:content>
                                </form:SimpleForm>
                            </VBox>
                            <VBox visible="{=${/scheduleType} === 'cycle'}">
                                <form:SimpleForm editable="true" layout="ResponsiveGridLayout"
                                                 labelSpanXL="4" labelSpanL="4" labelSpanM="12"
                                                 labelSpanS="12" adjustLabelSpan="false" emptySpanXL="0"
                                                 emptySpanL="0" emptySpanM="0" emptySpanS="0" columnsXL="2"
                                                 columnsL="2" columnsM="1" singleContainerFullSize="false">
                                    <form:content>
                                        <core:Title text=" 발송 일정"/>
                                        <Label text="단위"/>
                                        <ComboBox items="{/unitTypeDDLB}"
                                                  selectedKey="{/campaign/typeInfo/detail/cycleType}">
                                            <core:Item key="{key}" text="{text}"/>
                                        </ComboBox>
                                        <Label text="주기"/>
                                        <ComboBox items="{/periodTypeDDLB}"
                                                  selectedKey="{/campaign/typeInfo/detail/cyclePeriod}">
                                            <core:Item key="{key}" text="{text}"/>
                                        </ComboBox>
                                        <Label text="발송 시간"/>
                                        <DateTimePicker width="200px" enabled="true"
                                                        class="sapUiSmallMarginBottom"
                                                        valueFormat="yyyy-MM-dd HH:mm"
                                                        displayFormat="yyyy-MM-dd HH:mm"
                                                        value="{/campaign/typeInfo/detail/sendDatetime}"/>
                                    </form:content>
                                </form:SimpleForm>
                                <Label text="※발송예상일정 : 2023.03.03 08:00, 2023.03.04 08:00, 2023.03.05 08:00 ...."/>
                            </VBox>
                        </VBox>

                        <VBox visible="{=${/selectCampType} === 'userAction'}">
                            <Title text="유저 액션 캠페인"/>

                            <form:SimpleForm editable="true" layout="ResponsiveGridLayout" labelSpanXL="4"
                                             labelSpanL="4" labelSpanM="12" labelSpanS="12"
                                             adjustLabelSpan="false" emptySpanXL="0" emptySpanL="0"
                                             emptySpanM="0" emptySpanS="0" columnsXL="2" columnsL="2"
                                             columnsM="1" singleContainerFullSize="false">
                                <form:content>
                                    <core:Title text="액션 설정"/>
                                    <Label text="액션"/>
                                    <ComboBox items="{/actionTypeDDLB}" selectedKey="one">
                                        <core:Item key="{key}" text="{text}"/>
                                    </ComboBox>
                                </form:content>
                            </form:SimpleForm>

                            <t:Table class="Table1" rows="{/actionAttributeList}" selectionMode="None"
                                     visibleRowCount="5" paste="onPaste" ariaLabelledBy="title">
                                <t:extension>
                                    <OverflowToolbar style="Clear">
                                        <Title text="액션 인입시 체크할 속성값을 설정하세요."/>
                                        <ToolbarSpacer/>
                                        <Button text="추가" press="onPopupBrandSearchHelp"/>
                                        <Button text="삭제"/>
                                        <Button text="저장" press="onSave"/>
                                    </OverflowToolbar>
                                </t:extension>
                                <t:columns>
                                    <t:Column>
                                        <Label text="속성"/>
                                        <t:template>
                                            <Input value="{attribute}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="값"/>
                                        <t:template>
                                            <Input value="{value}"/>
                                        </t:template>
                                    </t:Column>
                                </t:columns>
                            </t:Table>

                        </VBox>
                        <VBox visible="{=${/selectCampType} === 'apiCall'}">
                            <Title text="API 호출 기반 캠페인"/>
                            <form:SimpleForm editable="true" layout="ResponsiveGridLayout" labelSpanXL="4"
                                             labelSpanL="4" labelSpanM="12" labelSpanS="12"
                                             adjustLabelSpan="false" emptySpanXL="0" emptySpanL="0"
                                             emptySpanM="0" emptySpanS="0" columnsXL="2" columnsL="2"
                                             columnsM="1" singleContainerFullSize="false">
                                <form:content>
                                    <core:Title text="외부에서 접근 가능한 URL을 설정하세요."/>
                                    <Label text="URL"/>
                                    <Input value="/api/campaign1.do" liveChange="onCreateFinalUrl"/>
                                    <Label text="최종 URL"/>
                                    <Input id="finalUrl"
                                           value="https://minicrmdev.eland.co.kr/api/campaign1.do"
                                           editable="false"/>
                                </form:content>
                            </form:SimpleForm>
                            <Label text="※최종 URL을 외부에 공유해주세요."/>
                        </VBox>
                        <VBox visible="{=${/selectCampType} === 'canvas'}">
                            <Title text="Canvas 시나리오 캠페인"/>
                            <Title text="→ 다음 단계에서 캠페인을 설정하세요."/>
                        </VBox>

                    </IconTabFilter>
                    <IconTabSeparator icon="sap-icon://arrow-right"
                                      visible="{=${/selectCampType} !== 'RB4'}"/>
                    <IconTabFilter text="세그먼트(필터)" key="members" id="membersTab"
                                   visible="{=${/selectCampType} !== 'RB4'}">
                        <t:Table class="Table1" rows="{/segList}" selectionMode="Single"
                                 selectionBehavior="Row" rowSelectionChange="onSegmentClick"
                                 visibleRowCount="5">
                            <t:extension>
                                <OverflowToolbar style="Clear">
                                    <Title text="세그먼트"/>
                                    <ToolbarSpacer/>
                                    <Button text="추가" press="onPopupBrandSearchHelp"/>
                                    <Button text="삭제"/>
                                    <Button text="저장" press="onSave"/>
                                </OverflowToolbar>
                            </t:extension>
                            <t:columns>
                                <t:Column>
                                    <Label text="순서"/>
                                    <t:template>
                                        <Text text="{seq}"/>
                                    </t:template>
                                </t:Column>
                                <t:Column>
                                    <Label text="유형"/>
                                    <t:template>
                                        <ComboBox items="{/segmentTypeDDLB}" selectedKey="{type}">
                                            <core:Item key="{key}" text="{text}"/>
                                        </ComboBox>
                                    </t:template>
                                </t:Column>
                                <t:Column>
                                    <Label text="세그먼트명"/>
                                    <t:template>
                                        <Text text="{segment}"/>
                                    </t:template>
                                </t:Column>
                                <t:Column>
                                    <Label text="필터"/>
                                    <t:template>
                                        <Link text="{filter}"/>
                                    </t:template>
                                </t:Column>
                                <t:Column>
                                    <Label text="누적 Count"/>
                                    <t:template>
                                        <Text text="{count}"/>
                                    </t:template>
                                </t:Column>
                            </t:columns>
                        </t:Table>
                        <t:Table class="Table1" rows="{/currentfilter}" selectionMode="MultiToggle"
                                 visibleRowCount="5" paste="onPaste" ariaLabelledBy="title">
                            <t:extension>
                                <OverflowToolbar style="Clear">
                                    <Title text="선택 세그먼트에 적용된 필터"/>
                                    <ToolbarSpacer/>
                                    <Button text="추가" press="onPopupBrandSearchHelp"/>
                                    <Button text="삭제"/>
                                    <Button text="저장" press="onSave"/>
                                </OverflowToolbar>
                            </t:extension>
                            <t:columns>
                                <t:Column>
                                    <Label text="속성"/>
                                    <t:template>
                                        <ComboBox items="{/attributeTypeDDLB}" selectedKey="{attribute}">
                                            <core:Item key="{key}" text="{text}"/>
                                        </ComboBox>
                                    </t:template>
                                </t:Column>
                                <t:Column>
                                    <Label text="연산자"/>
                                    <t:template>
                                        <ComboBox items="{/operatorTypeDDLB}" selectedKey="{operator}">
                                            <core:Item key="{key}" text="{text}"/>
                                        </ComboBox>
                                    </t:template>
                                </t:Column>
                                <t:Column>
                                    <Label text="값1"/>
                                    <t:template>
                                        <Input value="{value1}"/>
                                    </t:template>
                                </t:Column>
                                <t:Column>
                                    <Label text="값2"/>
                                    <t:template>
                                        <Input value="{value2}"/>
                                    </t:template>
                                </t:Column>
                            </t:columns>
                        </t:Table>
                    </IconTabFilter>
                    <IconTabSeparator icon="sap-icon://arrow-right"
                                      visible="{=${/selectCampType} !== 'RB4'}"/>
                    <IconTabFilter text="채널 설정" key="message" visible="{=${/selectCampType} !== 'RB4'}">
                        <Label labelFor="rbg1" text="캠페인 유형 설정"/>
                        <RadioButtonGroup id="msgTypeRadio" select="onMsgTypeClick" selectedIndex="-1"
                                          columns="6" width="100%" class="sapUiMediumMarginBottom">
                            <RadioButton id="MSG1" text="인앱팝업"/>
                            <RadioButton id="MSG2" text="문자"/>
                            <RadioButton id="MSG3" text="카카오톡"/>
                            <RadioButton id="MSG4" text="푸쉬"/>
                            <RadioButton id="MSG5" text="이메일"/>
                            <RadioButton id="MSG6" text="Braze 캠페인 실행 API 호출"/>
                        </RadioButtonGroup>

                        <Title text="메시지 유형에 맞는 작성 화면 출력 - 추후"/>
                    </IconTabFilter>
                    <IconTabSeparator icon="sap-icon://arrow-right"
                                      visible="{=${/selectCampType} !== 'RB4'}"/>
                    <IconTabFilter text="최종확인" key="message" visible="{=${/selectCampType} !== 'RB4'}">

                        <VBox>
                            <Title text="작성된 내용이 아래와 같습니다. 다시 한번 검토 후 하단에 실행 버튼을 눌러주세요."/>
                            <Title text=""/>
                            <Title text=""/>
                            <Title text=""/>
                            <Title text=""/>
                            <Button icon="sap-icon://activate" text="실행" press="onCampaignExecute"/>
                        </VBox>

                    </IconTabFilter>
                    <IconTabSeparator icon="sap-icon://arrow-right"
                                      visible="{=${/selectCampType} === 'RB4'}"/>
                    <IconTabFilter text="Canvas" key="canvas" visible="{=${/selectCampType} === 'RB4'}">
                        <Title text="Canvas 구성은 추후 작성"/>
                    </IconTabFilter>
                </items>
            </IconTabBar>
        </content>
    </Page>

</mvc:View>